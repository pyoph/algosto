#######################################################
################Directories############################
simDir = "~/Simus/DataSim"
resDir = "~/Simus/FitSim"
#######################################################
################à adapter en fonction de votre configuration
##########################################################

#Extraction des paramètres
kList = k1val
lList = l1val
rho1List = rho1val

linf1 = lList[1:4]

lsup1 = c(1,lList[5:7])

rho1ListNeg = rho1valNeg
# Plutot simNb que n

#############################Exploit results k, l, rho varying###############################################################################



erreursSigmak = array(0,dim = c(length(rList),length(kList),3))
erreursSigmaKLk = array(0,dim = c(length(rList),length(kList),3))
faux_negatifsRatek = array(0,dim = c(length(rList),length(kList),3))
faux_positifsRatek = array(0,dim = c(length(rList),length(kList),3))
l = 1
rho1 = rho0
for (i in seq_along(rList)){
  r = rList[i]
  nb_outliers = r/100*n
  nb_inliers = (1 - r/100)*n
  
  print(paste0("r = ",r))
  
  for (j in seq_along(kList)){
    k = kList[j]
    dataFile <- paste0('SimData-d', d, '-n', n, '-k', k, '-l', l, '-rho', rho1,'-r',r , '-sim', sim,".RData")

  #if(!file.exists(dataFile)){
  contParam = ParmsF1(m1, k, l, rho1)

  data = genererEchantillon(n,n,mu1 = mu0,mu2 = contParam$mu1,Sigma1 = Sigma0,Sigma2 = contParam$Sigma1,r )
  save(data, file=dataFile)
  print(paste0("n-",n,"d-",d,"k-",k,"l-",l,"r-",r,"-sim",sim," save ok"))

   # }
    #load(dataFile)
    
    
    print(paste0("nb_outliers = ",sum(data$labelsVrais == 1)))
    
    
    fitFile <- paste0('FitParms-d', d,  '-n', n, '-k', k, '-l', l, '-rho', rho1, '-r',r,'-sim', sim,".RData")
    #if(!file.exists(fitFile )){
      temps_naif = system.time(
        {fitNaif <- SampleCovOnline(data$Z)})
      print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
      if(d != 100){temps_online  = system.time({fitUsOnline <- StreamingOutlierDetection(data$Z,batch = 1)})}
      if(d == 100){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = 1,cutoff = 1.29*qchisq(0.95,df = d))})}
      
      print(norm(fitUsOnline$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
      #Changer cutoff si d = 100
      if(d != 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = max(floor(sqrt(ncol(data$Z))),10),cutoff = 1.38*qchisq(0.95,df = d))})}
      if(d == 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = ncol(data$Z))})}
      print(norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
      
      setwd(resDir)
      if(d != 100){save(fitNaif, fitUsOnline, fitUSStreaming,temps_naif,temps_online,temps_streaming,file=fitFile)}
      
    #}
    #if(file.exists(fitFile)){load(fitFile)}
    print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
    print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
    print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
    erreursSigmak[i,j,1] = norm(fitNaif$Sigma - Sigma0,"F")
    erreursSigmak[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    erreursSigmak[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    # parms2 <- list(
    #   mu = fitNaif$mean,
    #   Sigma = fitNaif$Sigma
    # ) 
    # erreursSigmaKLk[i,j,1] = KL(parms0,parms2 = parms2)
    # parms2 <- list(
    #   mu = t(fitUsOnline$moyennem),
    #   Sigma = fitUsOnline$Sigma[n,,]
    # ) 
    # erreursSigmaKLk[i,j,2] = KL(parms0,parms2 = parms2)
    # 
    # parms2 <- list(
    #   mu = t(fitUSStreaming$moyennem),
    #   Sigma = fitUSStreaming$Sigma[n,,]
    # )
    # erreursSigmaKLk[i,j,3] = KL(parms0,parms2 = parms2)
    # 
    #   erreursSigmaKLk[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    # erreursSigmaKLk[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    outliers_labelsRecNaive = fitNaif$outliers_labels
    outliers_labelsRecUsOnline = fitUsOnline$outlier_labels
    outliers_labelsRecUsStreaming = fitUSStreaming$outlier_labels
    
    if(nb_outliers != 0){
              fn_naive = (sum(outliers_labelsRecNaive == 0 & data$labelsVrais == 1)/(nb_outliers))*100
              faux_negatifsRatek[i,j,1] = fn_naive

              print(paste0("FN naïve ",fn_naive))
              fn_UsOnline = (sum(outliers_labelsRecUsOnline == 0 & data$labelsVrais == 1)/(nb_outliers))*100
              print(paste0("FN Us Online ",fn_UsOnline))

              faux_negatifsRatek[i,j,2] = fn_UsOnline
              fn_UsStreaming = sum(outliers_labelsRecUsStreaming == 0 & data$labelsVrais == 1)/(nb_outliers)*100
              print(paste0("FN Us Streaming ",fn_UsStreaming))
              faux_negatifsRatek[i,j,3] = fn_UsStreaming

            }
            fp_naive = (sum(outliers_labelsRecNaive == 1 & data$labelsVrais == 0)/(nb_inliers))*100

            print(paste0("FP naïve ",fp_naive))
            faux_positifsRatek[i,j,1] = fp_naive
            fp_UsOnline = (sum(outliers_labelsRecUsOnline == 1 & data$labelsVrais == 0)/(nb_inliers))*100

            print(paste0("FP us online  ",fp_UsOnline))
            faux_positifsRatek[i,j,2] = fp_UsOnline
            fp_UsStreaming = (sum(outliers_labelsRecUsStreaming == 1 & data$labelsVrais == 0)/(nb_inliers))*100
            faux_positifsRatek[i,j,3] = fp_UsStreaming

            print(paste0("FP us streaming  ",fp_UsStreaming))
            alpha <- 0.05
            
            x <- nb_inliers*alpha   # nombre de succès
            
            result <- binom.test(x, n, conf.level = 1 - alpha)
            
            # Affichage des résultats
            cat("Estimate of p:", result$estimate, "\n")
            cat("Exact", (1 - alpha) * 100, "% CI: [", 
                result$conf.int[1], ",", result$conf.int[2], "]\n")

  }
}

erreursSigmalinf1 = array(0,dim = c(length(rList),length(linf1),3))
erreursSigmaKLlinf1 = array(0,dim = c(length(rList),length(linf1),3))
faux_negatifsRatelinf1 = array(0,dim = c(length(rList),length(linf1),3))
faux_positifsRatelinf1 = array(0,dim = c(length(rList),length(linf1),3))


k = 0
rho1 = rho0
for (i in seq_along(rList)){
  r = rList[i]
  nb_outliers = r/100*n
  nb_inliers = (1 - r/100)*n
  for (j in seq_along(linf1)){
    
    l = linf1[j]
    
    dataFile <- paste0('SimData-d', d, '-n', n, '-k', k, '-l', l, '-rho', rho1,'-r',r , '-sim', sim,".RData")
    
    #if(!file.exists(dataFile)){
      contParam = ParmsF1(m1, k, l, rho1)
      
      data = genererEchantillon(n,n,mu1 = mu0,mu2 = contParam$mu1,Sigma1 = Sigma0,Sigma2 = contParam$Sigma1,r )
      save(data, file=dataFile)
      print(paste0("n-",n,"d-",d,"k-",k,"l-",l,"r-",r,"-sim",sim," save ok"))
      
    #}
    #load(dataFile)
    
    print(paste0("r = ",r))
    
    print(paste0("nb_outliers = ",sum(data$labelsVrais == 1)))
    
    
    fitFile <- paste0('FitParms-d', d,  '-n', n, '-k', k, '-l', l, '-rho', rho1, '-r',r,'-sim', sim,".RData")
    #if(!file.exists(fitFile )){
      temps_naif = system.time(
        {fitNaif <- SampleCovOnline(data$Z)})
      print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
      temps_online  = system.time({fitUsOnline <- StreamingOutlierDetection(data$Z,batch = 1)})
      print(norm(fitUsOnline$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
      #Changer cutoff si d = 100
      if(d == 100){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = sqrt(ncol(data$Z)),cutoff = 1.38*qchisq(0.95,df = d))})}
      if(d == 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = ncol(data$Z))})}
      print(norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
      
      setwd(resDir)
      if(d == 10){save(fitNaif, fitUsOnline, fitUSStreaming,temps_naif,temps_online,temps_streaming,file=fitFile)}
      
    #}
    #if(file.exists(fitFile)){load(fitFile)}
    #load(fitFile)
    print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
    print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
    print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
    erreursSigmalinf1[i,j,1] = norm(fitNaif$Sigma - Sigma0,"F")
    erreursSigmalinf1[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    erreursSigmalinf1[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    parms2 <- list(
      mu = fitNaif$mean,
      Sigma = fitNaif$Sigma
    ) 
    erreursSigmaKLlinf1[i,j,1] = KL(parms0,parms2 = parms2)
    
    print(paste0("erreur KL naive = ",erreursSigmaKLlinf1[i,j,1]))
    
    parms2 <- list(
      mu = t(fitUsOnline$moyennem),
      Sigma = fitUsOnline$Sigma[n,,]
    ) 
    erreursSigmaKLlinf1[i,j,2] = KL(parms0,parms2 = parms2)
    
    print(paste0("erreur KL online = ",erreursSigmaKLlinf1[i,j,2]))
    
    
    parms2 <- list(
      mu = t(fitUSStreaming$moyennem),
      Sigma = fitUSStreaming$Sigma[n,,]
    )
    erreursSigmaKLlinf1[i,j,3] = KL(parms0,parms2 = parms2)
    
    print(paste0("erreur KL streaming = ",erreursSigmaKLlinf1[i,j,3]))
    
    
    
    outliers_labelsRecNaive = fitNaif$outliers_labels
    outliers_labelsRecUsOnline = fitUsOnline$outlier_labels
    outliers_labelsRecUsStreaming = fitUSStreaming$outlier_labels
    
    if(nb_outliers != 0){
      fn_naive = (sum(outliers_labelsRecNaive == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      faux_negatifsRatelinf1[i,j,1] = fn_naive
      
      print(paste0("FN naïve ",fn_naive))
      fn_UsOnline = (sum(outliers_labelsRecUsOnline == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      print(paste0("FN Us Online ",fn_UsOnline))
      
      faux_negatifsRatelinf1[i,j,2] = fn_UsOnline
      fn_UsStreaming = sum(outliers_labelsRecUsStreaming == 0 & data$labelsVrais == 1)/(nb_outliers)*100
      print(paste0("FN Us Streaming ",fn_UsStreaming))
      faux_negatifsRatelinf1[i,j,3] = fn_UsStreaming
      
    }
    fp_naive = (sum(outliers_labelsRecNaive == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP naïve ",fp_naive))
    faux_positifsRatelinf1[i,j,1] = fp_naive
    fp_UsOnline = (sum(outliers_labelsRecUsOnline == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP us online  ",fp_UsOnline))
    faux_positifsRatelinf1[i,j,2] = fp_UsOnline
    fp_UsStreaming = (sum(outliers_labelsRecUsStreaming == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    faux_positifsRatelinf1[i,j,3] = fp_UsStreaming
    
    print(paste0("FP us streaming  ",fp_UsStreaming))
    
  }
}



erreursSigmalsup1 = array(0,dim = c(length(rList),length(lsup1),3))
erreursSigmaKLlsup1 = array(0,dim = c(length(rList),length(linf1),3))
faux_negatifsRatelsup1 = array(0,dim = c(length(rList),length(lsup1),3))
faux_positifsRatelsup1 = array(0,dim = c(length(rList),length(lsup1),3))
k = 0
rho1 = rho0
for (i in seq_along(rList)){
  r = rList[i]
  nb_outliers = r/100*n
  nb_inliers = (1 - r/100)*n
  for (j in seq_along(lsup1)){
    l = lsup1[j]
    
    dataFile <- paste0('SimData-d', d, '-n', n, '-k', k, '-l', l, '-rho', rho1,'-r',r , '-sim', sim,".RData")
    print(dataFile)
    #if(!file.exists(dataFile)){
      contParam = ParmsF1(m1, k, l, rho1)
      
      data = genererEchantillon(n,n,mu1 = mu0,mu2 = contParam$mu1,Sigma1 = Sigma0,Sigma2 = contParam$Sigma1,r )
      save(data, file=dataFile)
      print(paste0("n-",n,"d-",d,"k-",k,"l-",l,"r-",r,"-sim",sim," save ok"))
      
    #}
    #load(dataFile)
    
    print(paste0("r = ",r))
    
    print(paste0("nb_outliers = ",sum(data$labelsVrais == 1)))
    
    
    fitFile <- paste0('FitParms-d', d,  '-n', n, '-k', k, '-l', l, '-rho', rho1, '-r',r,'-sim', sim,".RData")
    #if(!file.exists(fitFile )){
      temps_naif = system.time(
        {fitNaif <- SampleCovOnline(data$Z)})
      print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
      temps_online  = system.time({fitUsOnline <- StreamingOutlierDetection(data$Z,batch = 1)})
      print(norm(fitUsOnline$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
      #Changer cutoff si d = 100
      if(d == 100){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = sqrt(ncol(data$Z)),cutoff = 1.38*qchisq(0.95,df = d))})}
      if(d == 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = ncol(data$Z))})}
      print(norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
      
      setwd(resDir)
      if(d == 10){save(fitNaif, fitUsOnline, fitUSStreaming,temps_naif,temps_online,temps_streaming,file=fitFile)}
      
    #}
    #if(file.exists(fitFile)){load(fitFile)}
    print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
    print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
    print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
    erreursSigmalsup1[i,j,1] = norm(fitNaif$Sigma - Sigma0,"F")
    erreursSigmalsup1[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    erreursSigmalsup1[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    
    parms2 <- list(
      mu = fitNaif$mean,
      Sigma = fitNaif$Sigma
    ) 
    erreursSigmaKLlsup1[i,j,1] = KL(parms0,parms2 = parms2)
    parms2 <- list(
      mu = t(fitUsOnline$moyennem),
      Sigma = fitUsOnline$Sigma[n,,]
    ) 
    erreursSigmaKLlsup1[i,j,2] = KL(parms0,parms2 = parms2)
    
    parms2 <- list(
      mu = t(fitUSStreaming$moyennem),
      Sigma = fitUSStreaming$Sigma[n,,]
    )
    erreursSigmaKLlsup1[i,j,3] = KL(parms0,parms2 = parms2)
    
    
    outliers_labelsRecNaive = fitNaif$outliers_labels
    outliers_labelsRecUsOnline = fitUsOnline$outlier_labels
    outliers_labelsRecUsStreaming = fitUSStreaming$outlier_labels
    
    if(nb_outliers != 0){
      fn_naive = (sum(outliers_labelsRecNaive == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      faux_negatifsRatelsup1[i,j,1] = fn_naive
      
      print(paste0("FN naïve ",fn_naive))
      fn_UsOnline = (sum(outliers_labelsRecUsOnline == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      print(paste0("FN Us Online ",fn_UsOnline))
      
      faux_negatifsRatelsup1[i,j,2] = fn_UsOnline
      fn_UsStreaming = sum(outliers_labelsRecUsStreaming == 0 & data$labelsVrais == 1)/(nb_outliers)*100
      print(paste0("FN Us Streaming ",fn_UsStreaming))
      faux_negatifsRatelsup1[i,j,3] = fn_UsStreaming
      
    }
    fp_naive = (sum(outliers_labelsRecNaive == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP naïve ",fp_naive))
    faux_positifsRatelsup1[i,j,1] = fp_naive
    fp_UsOnline = (sum(outliers_labelsRecUsOnline == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP us online  ",fp_UsOnline))
    faux_positifsRatelsup1[i,j,2] = fp_UsOnline
    fp_UsStreaming = (sum(outliers_labelsRecUsStreaming == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    faux_positifsRatelsup1[i,j,3] = fp_UsStreaming
    
    print(paste0("FP us streaming  ",fp_UsStreaming))
    
  }
}

erreursSigmaRho1 = array(0,dim = c(length(rList),length(rho1List),3))
erreursSigmaKLlRho1 = array(0,dim = c(length(rList),length(rho1List),3))
faux_negatifsRateRho1 = array(0,dim = c(length(rList),length(rho1List),3))
faux_positifsRateRho1 = array(0,dim = c(length(rList),length(rho1List),3))
k = 0
l = 1
for (i in seq_along(rList)){
  r = rList[i]
  nb_outliers = r/100*n
  nb_inliers = (1 - r/100)*n
  
  for (j in seq_along(rho1List)){
     rho1 = rho1List[j]
     
     dataFile <- paste0('SimData-d', d, '-n', n, '-k', k, '-l', l, '-rho', rho1,'-r',r , '-sim', sim,".RData")
     
     #if(!file.exists(dataFile)){
       contParam = ParmsF1(m1, k, l, rho1)
       
       data = genererEchantillon(n,n,mu1 = mu0,mu2 = contParam$mu1,Sigma1 = Sigma0,Sigma2 = contParam$Sigma1,r )
       save(data, file=dataFile)
       print(paste0("n-",n,"d-",d,"k-",k,"l-",l,"r-",r,"-sim",sim," save ok"))
       
     #}
     #load(dataFile)
     
     print(paste0("r = ",r))
     
     print(paste0("nb_outliers = ",sum(data$labelsVrais == 1)))
     
     
    fitFile <- paste0('FitParms-d', d,  '-n', n, '-k', k, '-l', l, '-rho', rho1, '-r',r,'-sim', sim,".RData")
    #if(!file.exists(fitFile )){
      temps_naif = system.time(
        {fitNaif <- SampleCovOnline(data$Z)})
      print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
      temps_online  = system.time({fitUsOnline <- StreamingOutlierDetection(data$Z,batch = 1)})
      print(norm(fitUsOnline$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
      #Changer cutoff si d = 100
      if(d == 100){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = sqrt(ncol(data$Z)),cutoff = 1.38*qchisq(0.95,df = d))})}
      if(d == 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = ncol(data$Z))})}
      print(norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
      
      setwd(resDir)
      if(d == 10){save(fitNaif, fitUsOnline, fitUSStreaming,temps_naif,temps_online,temps_streaming,file=fitFile)}
      
    #}
    #if(file.exists(fitFile)){load(fitFile)}
    print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
    print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
    print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
    erreursSigmaRho1[i,j,1] = norm(fitNaif$Sigma - Sigma0,"F")
    erreursSigmaRho1[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    erreursSigmaRho1[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    
    parms2 <- list(
      mu = fitNaif$mean,
      Sigma = fitNaif$Sigma
    ) 
    erreursSigmaKLlRho1[i,j,1] = KL(parms0,parms2 = parms2)
    parms2 <- list(
      mu = t(fitUsOnline$moyennem),
      Sigma = fitUsOnline$Sigma[n,,]
    ) 
    erreursSigmaKLlRho1[i,j,2] = KL(parms0,parms2 = parms2)
    
    parms2 <- list(
      mu = t(fitUSStreaming$moyennem),
      Sigma = fitUSStreaming$Sigma[n,,]
    )
    erreursSigmaKLlRho1[i,j,3] = KL(parms0,parms2 = parms2)
    
    
    outliers_labelsRecNaive = fitNaif$outliers_labels
    outliers_labelsRecUsOnline = fitUsOnline$outlier_labels
    outliers_labelsRecUsStreaming = fitUSStreaming$outlier_labels
    
    if(nb_outliers != 0){
      fn_naive = (sum(outliers_labelsRecNaive == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      faux_negatifsRateRho1[i,j,1] = fn_naive
      
      print(paste0("FN naïve ",fn_naive))
      fn_UsOnline = (sum(outliers_labelsRecUsOnline == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      print(paste0("FN Us Online ",fn_UsOnline))
      
      faux_negatifsRateRho1[i,j,2] = fn_UsOnline
      fn_UsStreaming = sum(outliers_labelsRecUsStreaming == 0 & data$labelsVrais == 1)/(nb_outliers)*100
      print(paste0("FN Us Streaming ",fn_UsStreaming))
      faux_negatifsRateRho1[i,j,3] = fn_UsStreaming
      
    }
    fp_naive = (sum(outliers_labelsRecNaive == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP naïve ",fp_naive))
    faux_positifsRateRho1[i,j,1] = fp_naive
    fp_UsOnline = (sum(outliers_labelsRecUsOnline == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP us online  ",fp_UsOnline))
    faux_positifsRateRho1[i,j,2] = fp_UsOnline
    fp_UsStreaming = (sum(outliers_labelsRecUsStreaming == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    faux_positifsRateRho1[i,j,3] = fp_UsStreaming
    
    print(paste0("FP us streaming  ",fp_UsStreaming))
    
  }
}


erreursSigmaRho1Neg = array(0,dim = c(length(rList),length(rho1ListNeg),3))
erreursSigmaKLlRho1Neg = array(0,dim = c(length(rList),length(rho1ListNeg),3))
faux_negatifsRateRho1Neg = array(0,dim = c(length(rList),length(rho1ListNeg),3))
faux_positifsRateRho1Neg = array(0,dim = c(length(rList),length(rho1ListNeg),3))

k = 0
l = 1
for (i in seq_along(rList)){
  r = rList[i]
  nb_outliers = r/100*n
  nb_inliers = (1 - r/100)*n
  
  for (j in seq_along(rho1ListNeg)){
    rho1 = rho1List[j]
    dataFile <- paste0('SimData-d', d, '-n', n, '-k', k, '-l', l, '-rho', rho1,'-r',r , '-sim', sim,".RData")
    
    #if(!file.exists(dataFile)){
      contParam = ParmsF1(m1, k, l, rho1)
      
      data = genererEchantillon(n,n,mu1 = mu0,mu2 = contParam$mu1,Sigma1 = Sigma0,Sigma2 = contParam$Sigma1,r )
      save(data, file=dataFile)
      print(paste0("n-",n,"d-",d,"k-",k,"l-",l,"r-",r,"-sim",sim," save ok"))
      
    #}
    #load(dataFile)
    
    print(paste0("r = ",r))
    
    print(paste0("nb_outliers = ",sum(data$labelsVrais == 1)))
    
    
    fitFile <- paste0('FitParms-d', d,  '-n', n, '-k', k, '-l', l, '-rho', rho1, '-r',r,'-sim', sim,".RData")
    setwd(resDir)
    #if(!file.exists(fitFile )){
      temps_naif = system.time(
        {fitNaif <- SampleCovOnline(data$Z)})
      print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
      temps_online  = system.time({fitUsOnline <- StreamingOutlierDetection(data$Z,batch = 1)})
      print(norm(fitUsOnline$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
      #Changer cutoff si d = 100
      if(d == 100){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = sqrt(ncol(data$Z)),cutoff = 1.38*qchisq(0.95,df = d))})}
      if(d == 10){temps_streaming = system.time({fitUSStreaming =StreamingOutlierDetection(data$Z,batch = ncol(data$Z))})}
      print(norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F"))
      print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
      
      setwd(resDir)
      if(d == 10){save(fitNaif, fitUsOnline, fitUSStreaming,temps_naif,temps_online,temps_streaming,file=fitFile)}
      
    #}
    #if(file.exists(fitFile)){load(fitFile)}
    print(paste0("Erreur Naif = ",norm(fitNaif$Sigma - Sigma0,"F")))
    print(paste0("Erreur online = ",norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")))
    print(paste0("Erreur streaming = ",norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")))
    erreursSigmaRho1Neg[i,j,1] = norm(fitNaif$Sigma - Sigma0,"F")
    erreursSigmaRho1Neg[i,j,2] = norm(fitUsOnline$Sigma[n,,] - Sigma0,"F")
    erreursSigmaRho1Neg[i,j,3] = norm(fitUSStreaming$Sigma[n,,] - Sigma0,"F")
    
    
    parms2 <- list(
      mu = fitNaif$mean,
      Sigma = fitNaif$Sigma
    ) 
    erreursSigmaKLlRho1Neg[i,j,1] = KL(parms0,parms2 = parms2)
    parms2 <- list(
      mu = t(fitUsOnline$moyennem),
      Sigma = fitUsOnline$Sigma[n,,]
    ) 
    erreursSigmaKLlRho1Neg[i,j,2] = KL(parms0,parms2 = parms2)
    
    parms2 <- list(
      mu = t(fitUSStreaming$moyennem),
      Sigma = fitUSStreaming$Sigma[n,,]
    )
    erreursSigmaKLlRho1Neg[i,j,3] = KL(parms0,parms2 = parms2)
    
    
    outliers_labelsRecNaive = fitNaif$outliers_labels
    outliers_labelsRecUsOnline = fitUsOnline$outlier_labels
    outliers_labelsRecUsStreaming = fitUSStreaming$outlier_labels
    
    if(nb_outliers != 0){
      fn_naive = (sum(outliers_labelsRecNaive == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      faux_negatifsRateRho1Neg[i,j,1] = fn_naive
      
      print(paste0("FN naïve ",fn_naive))
      fn_UsOnline = (sum(outliers_labelsRecUsOnline == 0 & data$labelsVrais == 1)/(nb_outliers))*100
      print(paste0("FN Us Online ",fn_UsOnline))
      
      faux_negatifsRateRho1Neg[i,j,2] = fn_UsOnline
      fn_UsStreaming = sum(outliers_labelsRecUsStreaming == 0 & data$labelsVrais == 1)/(nb_outliers)*100
      print(paste0("FN Us Streaming ",fn_UsStreaming))
      faux_negatifsRateRho1Neg[i,j,3] = fn_UsStreaming
      
    }
    fp_naive = (sum(outliers_labelsRecNaive == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP naïve ",fp_naive))
    faux_positifsRateRho1Neg[i,j,1] = fp_naive
    fp_UsOnline = (sum(outliers_labelsRecUsOnline == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    
    print(paste0("FP us online  ",fp_UsOnline))
    faux_positifsRateRho1Neg[i,j,2] = fp_UsOnline
    fp_UsStreaming = (sum(outliers_labelsRecUsStreaming == 1 & data$labelsVrais == 0)/(nb_inliers))*100
    faux_positifsRateRho1Neg[i,j,3] = fp_UsStreaming
    
    print(paste0("FP us streaming  ",fp_UsStreaming))
    
  }
}

save(erreursSigmalsup1,erreursSigmaRho1Neg,erreursSigmaRho1Neg,file="erreursSigmalsupRho1.RData")


setwd("~")
pdf("frobnormerrorklkd10.pdf", width = 7, height = 5)

#######################Plot erreurs Sigma k#############################
plot(rList, erreursSigmak[,4,3],
     type = "l", lwd = 4, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-1, 1e2)) # on redessine les axes manuellement

# Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmak[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmaRho1[erreursSigmalsup1[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmak[,4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList,erreursSigmak[,4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmak[,3,3],col = "orange",lwd = 4)
lines(rList,erreursSigmak[,3,2],col = "orange",lty = "dashed",lwd = 4)
lines(rList,erreursSigmak[,3,1],col = "orange",lty = "dotted",lwd = 4)
#############KL 1############################
lines(rList,erreursSigmak[,2,3],col = "darkgreen",lwd = 4)
lines(rList,erreursSigmak[,2,2],col = "darkgreen",lty = "dashed",lwd = 4)
lines(rList,erreursSigmak[,2,1],col = "darkgreen",lty = "dotted",lwd = 4)
#############KL 0############################
lines(rList,erreursSigmak[,1,3],col = "blue",lwd = 4)
lines(rList,erreursSigmak[,1,2],col = "blue",lty = "dashed",lwd = 4)
lines(rList,erreursSigmak[,1,1],col = "blue",lty = "dotted",lwd = 4)


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


log_ticks <- 10^seq(-1, 2, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -1:2)),cex.axis = 2.3)
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5),cex.axis= 2.3)
dev.off()


setwd("~")
pdf("frobnormerrorkllsup1d10.pdf", width = 7, height = 5)

#######################Plot erreurs Sigma lsup 1#############################
plot(rList, erreursSigmalsup1[,4,3],
     type = "l", lwd = 4, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-1, 1e2)) # on redessine les axes manuellement

# Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmak[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmaRho1[erreursSigmalsup1[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmalsup1[,4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList,erreursSigmalsup1[,4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmalsup1[,3,3],col = "orange",lwd = 4)
lines(rList,erreursSigmalsup1[,3,2],col = "orange",lty = "dashed",lwd = 4)
lines(rList,erreursSigmalsup1[,3,1],col = "orange",lty = "dotted",lwd = 4)
#############KL 1############################
lines(rList,erreursSigmalsup1[,2,3],col = "darkgreen",lwd = 4)
lines(rList,erreursSigmalsup1[,2,2],col = "darkgreen",lty = "dashed",lwd = 4)
lines(rList,erreursSigmalsup1[,2,1],col = "darkgreen",lty = "dotted",lwd = 4)
#############KL 0############################
lines(rList,erreursSigmalsup1[,1,3],col = "blue",lwd = 4)
lines(rList,erreursSigmalsup1[,1,2],col = "blue",lty = "dashed",lwd = 4)
lines(rList,erreursSigmalsup1[,1,1],col = "blue",lty = "dotted",lwd = 4)


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


log_ticks <- 10^seq(-1, 2, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -1:2)),cex.axis = 2.3)
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5),cex.axis= 2.3)

dev.off()

setwd("~")
pdf("frobnormerrorklrho1d10.pdf", width = 7, height = 5)


#######################Plot erreurs Sigma Rho1#############################
plot(rList, erreursSigmaRho1[,4,3],
     type = "l", lwd = 4, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-1, 1e2)) # on redessine les axes manuellement

# Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmak[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmaRho1[erreursSigmalsup1[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmaRho1[,4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList,erreursSigmaRho1[,4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmaRho1[,3,3],col = "orange",lwd = 4)
lines(rList,erreursSigmaRho1[,3,2],col = "orange",lty = "dashed",lwd = 4)
lines(rList,erreursSigmaRho1[,3,1],col = "orange",lty = "dotted",lwd = 4)
#############KL 1############################
lines(rList,erreursSigmaRho1[,2,3],col = "darkgreen",lwd = 4)
lines(rList,erreursSigmaRho1[,2,2],col = "darkgreen",lty = "dashed",lwd = 4)
lines(rList,erreursSigmaRho1[,2,1],col = "darkgreen",lty = "dotted",lwd = 4)
#############KL 0############################
lines(rList,erreursSigmaRho1[,1,3],col = "blue",lwd = 4)
lines(rList,erreursSigmaRho1[,1,2],col = "blue",lty = "dashed",lwd = 4)
lines(rList,erreursSigmaRho1[,1,1],col = "blue",lty = "dotted",lwd = 4)


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


log_ticks <- 10^seq(-1, 2, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -1:2)),cex.axis = 2.3)
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5),cex.axis= 2.3)

dev.off()

setwd("~")

pdf("falsenegativesklkd10.pdf", width = 7, height = 5)

#######################Plot faux négatifs k#############################
plot(rList[2:length(rList)], faux_negatifsRatek[(2:length(rList)),4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,3],lwd = 4,col = "orange")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,3],lwd = 4,col = "darkgreen")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,2],lwd = 4,col = "darkgreen",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,3],lwd = 4,col = "blue")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,2],,lwd = 4,col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 1.8)


dev.off()



setwd("~")

pdf("falsenegativeskllsup1d10.pdf", width = 7, height = 5)

#######################Plot faux négatifs l >= 1#############################
plot(rList[2:length(rList)], faux_negatifsRatelsup1[(2:length(rList)),4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,3],lwd = 4,col = "orange")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,3],lwd = 4,col = "darkgreen")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,2],lwd = 4,col = "darkgreen",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,3],lwd = 4,col = "blue")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,2],,lwd = 4,col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 1.8)


dev.off()


setwd("~")

pdf("falsenegativesklrho1d10.pdf", width = 7, height = 5)

#######################Plot faux négatifs l >= 1#############################
plot(rList[2:length(rList)], faux_negatifsRateRho1[(2:length(rList)),4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,3],lwd = 4,col = "orange")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,3],lwd = 4,col = "darkgreen")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,2],lwd = 4,col = "darkgreen",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,3],lwd = 4,col = "blue")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,2],,lwd = 4,col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 1.8)


dev.off()


setwd("~")

pdf("falsepositivesklkd10.pdf", width = 7, height = 5)


#######################Plot faux positifs k#############################
plot(rList, faux_positifsRatek[,4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 20)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRatek[,4,2],lwd = 4,col = "red",lty = "dashed")
lines(rList,faux_positifsRatek[,4,1],lwd = 4,col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRatek[,3,3],lwd = 4,col = "orange")
lines(rList,faux_positifsRatek[,3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList,faux_positifsRatek[,3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRatek[,2,3],lwd = 4,col = "darkgreen")
lines(rList,faux_positifsRatek[,2,2],lwd =4,col = "darkgreen",lty = "dashed")
lines(rList,faux_positifsRatek[,2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRatek[,1,3],lwd = 4,col = "blue")
lines(rList,faux_positifsRatek[,1,2],lwd = 4,col = "blue",lty = "dashed")
lines(rList,faux_positifsRatek[,1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(0, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 2.3)


dev.off()



setwd("~")

pdf("falsepositiveskllsup1d10.pdf", width = 7, height = 5)


#######################Plot faux positifs k#############################
plot(rList, faux_positifsRatelsup1[,4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 20)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRatelsup1[,4,2],lwd = 4,col = "red",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,4,1],lwd = 4,col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRatelsup1[,3,3],lwd = 4,col = "orange")
lines(rList,faux_positifsRatelsup1[,3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRatelsup1[,2,3],lwd = 4,col = "darkgreen")
lines(rList,faux_positifsRatelsup1[,2,2],lwd =4,col = "darkgreen",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRatelsup1[,1,3],lwd = 4,col = "blue")
lines(rList,faux_positifsRatelsup1[,1,2],lwd = 4,col = "blue",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(0, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 2.3)


dev.off()



setwd("~")

pdf("falsepositivesklrho1d10.pdf", width = 7, height = 5)


#######################Plot faux positifs k#############################
plot(rList, faux_positifsRateRho1[,4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 20)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRateRho1[,4,2],lwd = 4,col = "red",lty = "dashed")
lines(rList,faux_positifsRateRho1[,4,1],lwd = 4,col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRateRho1[,3,3],lwd = 4,col = "orange")
lines(rList,faux_positifsRateRho1[,3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList,faux_positifsRateRho1[,3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRateRho1[,2,3],lwd = 4,col = "darkgreen")
lines(rList,faux_positifsRateRho1[,2,2],lwd =4,col = "darkgreen",lty = "dashed")
lines(rList,faux_positifsRateRho1[,2,1],lwd = 4,col = "darkgreen",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRateRho1[,1,3],lwd = 4,col = "blue")
lines(rList,faux_positifsRateRho1[,1,2],lwd = 4,col = "blue",lty = "dashed")
lines(rList,faux_positifsRateRho1[,1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(0, max(rList), by = 5),cex.axis = 2.3)



# Axe X tous les 50

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 2.3)


dev.off()


#######################Plot erreurs Sigma l inf 1#############################
plot(rList, erreursSigmalinf1[,4,3],
     type = "l", lwd = 2, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-2, 1e9)) # on redessine les axes manuellement
# Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmak[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmak[erreursSigmak[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmalinf1[,4,2],col = "red",lty = "dashed")
lines(rList,erreursSigmalinf1[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmalinf1[,3,3],col = "orange")
lines(rList,erreursSigmalinf1[,3,2],col = "orange",lty = "dashed")
lines(rList,erreursSigmalinf1[,3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,erreursSigmalinf1[,2,3],col = "green")
lines(rList,erreursSigmalinf1[,2,2],col = "green",lty = "dashed")
lines(rList,erreursSigmalinf1[,2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList,erreursSigmalinf1[,1,3],col = "blue")
lines(rList,erreursSigmalinf1[,1,2],col = "blue",lty = "dashed")
lines(rList,erreursSigmalinf1[,1,1],col = "blue",lty = "dotted")



log_ticks <- 10^seq(-2, 9, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -2:9)))
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5))



#######################Plot faux positifs l <= 1#############################
plot(rList, faux_positifsRatelinf1[,4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n"
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     # ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRatelinf1[,4,2],col = "red",lty = "dashed")
lines(rList,faux_positifsRatelinf1[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRatelinf1[,3,3],col = "orange")
lines(rList,faux_positifsRatelinf1[,3,2],col = "orange",lty = "dashed")
lines(rList,faux_positifsRatelinf1[,3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRatelinf1[,2,3],col = "green")
lines(rList,faux_positifsRatelinf1[,2,2],col = "green",lty = "dashed")
lines(rList,faux_positifsRatelinf1[,2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRatelinf1[,1,3],col = "blue")
lines(rList,faux_positifsRatelinf1[,1,2],col = "blue",lty = "dashed")
lines(rList,faux_positifsRatelinf1[,1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5))




axis(2, at = seq(0, 100, by = 5),las = 1)





#######################Plot faux négatifs l <= 1#############################
plot(rList[2:length(rList)], faux_negatifsRatelinf1[(2:length(rList)),4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),4,2],col = "red",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),3,3],col = "orange")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),3,2],col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),2,3],col = "green")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),2,2],col = "green",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),1,3],col = "blue")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),1,2],col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelinf1[(2:length(rList)),1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 5
axis(1, at = seq(5, max(rList), by = 5))


axis(2, at = seq(0, 100, by = 5),las = 1)





#######################Plot erreurs Sigma l sup 1#############################
plot(rList, erreursSigmalsup1[,4,3],
     type = "l", lwd = 2, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-2, 1e9)) # on redessine les axes manuellement
# # Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmalsup1[,4,1], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmak[erreursSigmalsup1[,4,1] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmalsup1[,4,2],col = "red",lty = "dashed")
lines(rList,erreursSigmalsup1[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmalsup1[,3,3],col = "orange")
lines(rList,erreursSigmalsup1[,3,2],col = "orange",lty = "dashed")
lines(rList,erreursSigmalsup1[,3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,erreursSigmalsup1[,2,3],col = "green")
lines(rList,erreursSigmalsup1[,2,2],col = "green",lty = "dashed")
lines(rList,erreursSigmalsup1[,2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList,erreursSigmalsup1[,1,3],col = "blue")
lines(rList,erreursSigmalsup1[,1,2],col = "blue",lty = "dashed")
lines(rList,erreursSigmalsup1[,1,1],col = "blue",lty = "dotted")

log_ticks <- 10^seq(-2, 9, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -2:9)))
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5))



#######################Plot faux négatifs lsup 1#############################
plot(rList[2:length(rList)], faux_negatifsRatelsup1[(2:length(rList)),4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),4,2],col = "red",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,3],col = "orange")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,2],col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,3],col = "green")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,2],col = "green",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,3],col = "blue")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,2],col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRatelsup1[(2:length(rList)),1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 5
axis(1, at = seq(5, max(rList), by = 5))


axis(2, at = seq(0, 100, by = 5),las = 1)


#######################Plot faux positifs l >= 1#############################
plot(rList, faux_positifsRatelsup1[,4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n"
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     # ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRatelsup1[,4,2],col = "red",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRatelsup1[,3,3],col = "orange")
lines(rList,faux_positifsRatelsup1[,3,2],col = "orange",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRatelsup1[,2,3],col = "green")
lines(rList,faux_positifsRatelsup1[,2,2],col = "green",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRatelsup1[,1,3],col = "blue")
lines(rList,faux_positifsRatelsup1[,1,2],col = "blue",lty = "dashed")
lines(rList,faux_positifsRatelsup1[,1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5))

axis(2, at = seq(0, 8, by = 1),las = 1)


#######################Plot erreurs rho1 >= 0.3#############################
plot(rList, erreursSigmaRho1[,4,3],
     type = "l", lwd = 4, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n", # on redessine les axes manuellement
ylim = c(1e-2, 1e9)) 
# # Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmalsup1[,4,1], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmak[erreursSigmalsup1[,4,1] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmaRho1[,4,2],lwd = 4,col = "red",lty = "dashed")
lines(rList,erreursSigmaRho1[,4,1],lwd = 4,col = "red",lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmaRho1[,3,3],lwd = 4,col = "orange")
lines(rList,erreursSigmaRho1[,3,2],lwd = 4,col = "orange",lty ="dashed")
lines(rList,erreursSigmaRho1[,3,1],lwd = 4,col = "orange",lty ="dotted")
#############KL 1############################
lines(rList,erreursSigmaRho1[,2,3],lwd = 4,col = "green")
lines(rList,erreursSigmaRho1[,2,2],lwd = 4,col = "green",lty ="dashed")
lines(rList,erreursSigmaRho1[,2,1],lwd = 4,col = "green",lty ="dotted")
#############KL 1############################
lines(rList,erreursSigmaRho1[,1,3],lwd = 4,col = "blue")
lines(rList,erreursSigmaRho1[,1,2],lwd = 4,col = "blue",lty ="dashed")
lines(rList,erreursSigmaRho1[,1,1],lwd = 4,col = "blue",lty ="dotted")


log_ticks <- 10^seq(-2, 9, by = 1)  # ticks de 10^-2 à 10^5
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -2:9)),cex.axis = 1.8)
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5),cex.axis = 1.8)

#######################Plot faux positifs rho1 >= 0.3 #############################
plot(rList, faux_positifsRateRho1[,4,3],
     type = "l", lwd = 4, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n"
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     # ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRateRho1[,4,2],col = "red",lwd = 4,lty = "dashed")
lines(rList,faux_positifsRateRho1[,4,1],col = "red",lwd = 4,lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRateRho1[,3,3],lwd = 4,col = "orange")
lines(rList,faux_positifsRateRho1[,3,2],lwd = 4,col = "orange",lty = "dashed")
lines(rList,faux_positifsRateRho1[,3,1],lwd = 4,col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRateRho1[,2,3],lwd = 4,col = "green")
lines(rList,faux_positifsRateRho1[,2,2],lwd = 4,col = "green",lty = "dashed")
lines(rList,faux_positifsRateRho1[,2,1],lwd = 4,col = "green",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRateRho1[,1,3],lwd = 4,col = "blue")
lines(rList,faux_positifsRateRho1[,1,2],lwd = 4,col = "blue",lty = "dashed")
lines(rList,faux_positifsRateRho1[,1,1],lwd = 4,col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5),cex.axis = 1.8)

axis(2, at = seq(0, 100, by = 5),las = 1,cex.axis = 1.8)






#######################Plot faux négatifs rho1 <= 0.3#############################
plot(rList[2:length(rList)], faux_negatifsRateRho1[(2:length(rList)),4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,2],col = "red",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,3],col = "orange")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,2],col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,3],col = "green")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,2],col = "green",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,3],col = "blue")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,2],col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1[(2:length(rList)),1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 5
axis(1, at = seq(5, max(rList), by = 5))


axis(2, at = seq(0, 100, by = 5),las = 1)




#######################Plot erreurs rho1 <= 0.3#############################
plot(rList, erreursSigmaRho1Neg[,4,3],
     type = "l", lwd = 2, col = "red",
     log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     ylim = c(1e-2, 1e9)) # on redessine les axes manuellement
# # Axe Y en log10 avec labels 10^k
# ylim <- range(erreursSigmalsup1[,4,1], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(erreursSigmak[erreursSigmalsup1[,4,1] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,erreursSigmaRho1Neg[,4,2],col = "red",lty = "dashed")
lines(rList,erreursSigmaRho1Neg[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,erreursSigmaRho1Neg[,3,3],col = "orange")
lines(rList,erreursSigmaRho1Neg[,3,2],col = "orange",lty ="dashed")
lines(rList,erreursSigmaRho1Neg[,3,1],col = "orange",lty ="dotted")
#############KL 1############################
lines(rList,erreursSigmaRho1Neg[,2,3],col = "green")
lines(rList,erreursSigmaRho1Neg[,2,2],col = "green",lty ="dashed")
lines(rList,erreursSigmaRho1Neg[,2,1],col = "green",lty ="dotted")
#############KL 1############################
lines(rList,erreursSigmaRho1Neg[,1,3],col = "blue")
lines(rList,erreursSigmaRho1Neg[,1,2],col = "blue",lty ="dashed")
lines(rList,erreursSigmaRho1Neg[,1,1],col = "blue",lty ="dotted")


log_ticks <- 10^seq(-2, 9, by = 1)  
axis(2, at = log_ticks,
     labels = parse(text = paste0("10^", -2:9)))
# Axe X tous les 50
axis(1, at = seq(min(rList), max(rList), by = 5))



#######################Plot faux négatifs rho1 <= 0.3#############################
plot(rList[2:length(rList)], faux_negatifsRateRho1Neg[(2:length(rList)),4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n",
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),4,2],col = "red",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),3,3],col = "orange")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),3,2],col = "orange",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),2,3],col = "green")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),2,2],col = "green",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),1,3],col = "blue")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),1,2],col = "blue",lty = "dashed")
lines(rList[2:length(rList)],faux_negatifsRateRho1Neg[(2:length(rList)),1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 5
axis(1, at = seq(5, max(rList), by = 5))


axis(2, at = seq(0, 100, by = 5),las = 1)


#######################Plot faux positifs rho1 <= 0.3 #############################
plot(rList, faux_positifsRateRho1Neg[,4,3],
     type = "l", lwd = 2, col = "red",
     #log = "y",              # axe Y en log10
     xlab = "", ylab = "",   # pas de noms d'axes
     yaxt = "n", xaxt = "n"
     #ylim = c(0, 1e2)) # on redessine les axes manuellement
     # ylim = c(0, 1e2)
)
# Axe Y en log10 avec labels 10^k
# ylim <- range(faux_negatifsRatek[,4,3], na.rm = TRUE)
# ylim[1] <- max(ylim[1], min(faux_negatifsRatek[faux_negatifsRatek[,4,3] > 0,4,3], na.rm = TRUE)) # > 0
#############KL 100############################
lines(rList,faux_positifsRateRho1Neg[,4,2],col = "red",lty = "dashed")
lines(rList,faux_positifsRateRho1Neg[,4,1],col = "red",lty = "dotted")
#############KL 10############################
lines(rList,faux_positifsRateRho1Neg[,3,3],col = "orange")
lines(rList,faux_positifsRateRho1Neg[,3,2],col = "orange",lty = "dashed")
lines(rList,faux_positifsRateRho1Neg[,3,1],col = "orange",lty = "dotted")
#############KL 1############################
lines(rList,faux_positifsRateRho1Neg[,2,3],col = "green")
lines(rList,faux_positifsRateRho1Neg[,2,2],col = "green",lty = "dashed")
lines(rList,faux_positifsRateRho1Neg[,2,1],col = "green",lty = "dotted")
#############KL 0############################
lines(rList,faux_positifsRateRho1Neg[,1,3],col = "blue")
lines(rList,faux_positifsRateRho1Neg[,1,2],col = "blue",lty = "dashed")
lines(rList,faux_positifsRateRho1Neg[,1,1],col = "blue",lty = "dotted")


# log_ticks <- 10^seq(floor(log10(ylim[1])), ceiling(log10(ylim[2])), by = 1)
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", seq(floor(log10(ylim[1])),
#                                              ceiling(log10(ylim[2])), 1))))


# log_ticks <- 10^seq(-2, 2, by = 1)  # ticks de 10^-2 à 10^5
# axis(2, at = log_ticks,
#      labels = parse(text = paste0("10^", -2:2)))
# # Axe X tous les 50
axis(1, at = seq(5, max(rList), by = 5))

axis(2, at = seq(0, 100, by = 5),las = 1)
